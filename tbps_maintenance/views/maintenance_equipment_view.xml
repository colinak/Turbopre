<?xml version="1.0" encoding="UTF-8"?>
<odoo>
  <data>

    <record id="inherit_hr_equipment_view_kanban" model="ir.ui.view">
      <field name="name">inherit.maintenance.equipment.kanban</field>
      <field name="model">maintenance.equipment</field>
      <field name="inherit_id" ref="hr_maintenance.maintenance_equipment_view_kanban_inherit_hr" />
      <field name="arch" type="xml">
        <div t-if="!record.employee_id.raw_value" position="replace">
          <field name="equipment_assign_to" attrs="{'invisible': [('equipment_assign_to', '!=', 'unassigned')]}" />
          <div t-if="record.other != False">
            <field name="other" />
          </div>
        </div>
      </field>
    </record>

    <!--herencia de vista formulario de equipos-->
    <record id="inherit_hr_equipment_view_form" model="ir.ui.view">
      <field name="name">inherit.equipment.form</field>
      <field name="model">maintenance.equipment</field>
      <field name="inherit_id" ref="maintenance.hr_equipment_view_form"/>
      <field name="arch" type="xml">
        <xpath expr="//sheet[1]" position="before">
          <header>
            <button string="Replace Equipment" name="%(tbps_maintenance.action_replace_equipment)d"
              type="action" class="oe_highlight" attrs="{'invisible': [('stage', '!=', 'assigned')]}" />
            <button string="Discarded Equipment" class="oe_highlight" attrs="{'invisible': [('stage', '=', 'discarded')]}" />
            <button string="Refurbish Equipment"  class="oe_highlight" attrs="{'invisible': [('stage', '!=', 'discarded')]}" />
            <field name="stage" widget="statusbar" statusbar_visible="available,assigned,discarded"/>
          </header>
        </xpath>
        <field name="category_id" position="attributes">
          <attribute name="required">1</attribute>
        </field>
        <field name="maintenance_team_id" position="attributes">
          <attribute name="required">1</attribute>
        </field>
        <field name="maintenance_team_id" position="before">
          <field name="type_assignment" placeholder="Seleccione" 
            readonly="1"
            attrs="{'invisible': [('equipment_assign_to', '=', 'unassigned')]}"  
          />
        </field>
        <field name="technician_user_id" position="replace">
          <field name="depto_responsible_id" />
        </field>
        <field name="partner_ref" position="replace">
          <field name="brand_id" />
        </field>
        <field name="assign_date" position="attributes">
          <attribute name="attrs">{
              'invisible': [('equipment_assign_to', '=', 'unassigned')],
              'required': True
            }
          </attribute>
        </field>
        <field name="scrap_date" position="attributes">
          <attribute name="attrs">
            {
              'invisible': [('stage', '!=', 'discarded')]
            }
          </attribute>
        </field>
        <field name="location" position="attributes">
          <attribute name="attrs">{'invisible': [('equipment_assign_to', '=', 'unassigned')]}</attribute>
        </field>
        <!--<field name="model" position="attributes">-->
          <!--<attribute name="required">1</attribute>-->
        <!--</field>-->
        <!--<field name="serial_no" position="attributes">-->
          <!--<attribute name="required">1</attribute>-->
        <!--</field>-->
      </field>
    </record>

    <!--herencia de vista tree de equipos-->
    <record id="inherit_hr_equipment_view_tree" model="ir.ui.view">
      <field name="name">inherit.equipment.tree</field>
      <field name="model">maintenance.equipment</field>
      <field name="inherit_id" ref="maintenance.hr_equipment_view_tree"/>
      <field name="arch" type="xml">
        <field name="technician_user_id" position="replace">
          <field name="depto_responsible_id" />
        </field>
      </field>
    </record>

    <!--herencia de vista tree de equipos-->
    <record id="inherit_maintenance_equipment_view_form_inherit_hr" model="ir.ui.view">
      <field name="name">inheirt.maintenance.equipment.view.form.inherit.hr</field>
      <field name="model">maintenance.equipment</field>
      <field name="inherit_id" ref="hr_maintenance.maintenance_equipment_view_form_inherit_hr"/>
      <field name="arch" type="xml">
        <field name="employee_id" position="replace">
          <field name="employee_id" string="Employee" 
            attrs="{
            'invisible': 
              ['|', 
                ('equipment_assign_to', '!=', 'employee'), 
                ('equipment_assign_to', '=', False)
              ],
            'required':
              [('equipment_assign_to', '=', 'employee')]
            }"
          />
        </field>
        <field name="department_id" position="replace">
          <field name="department_id" string="Department" 
            attrs="{
            'invisible': 
              ['|', 
                ('equipment_assign_to', '!=', 'department'), 
                ('equipment_assign_to', '=', False)
              ],
            'required':
              [('equipment_assign_to', '=', 'department')]
            }"
          />
        </field>
        <field name="department_id" position="after">
          <field name="other" 
            attrs="{'invisible': [('equipment_assign_to', '!=', 'other')], 'required': [('equipment_assign_to', '=', 'other')]}"/>
        </field>
      </field>
    </record>

  </data>
</odoo>

